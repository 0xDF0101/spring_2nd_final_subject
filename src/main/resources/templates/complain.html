
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>문의하기</title>
</head>
<body>


<h1>여기는 문의하기 창</h1>
<h3>오늘도 개쩌는 하루가 되시길 바랍니다.</h3>
<form method="post" action="/cs/customer/complain" id="uploadForm" enctype="multipart/form-data">
    제목 : <input type="text" name="title" /><br />
    작성자 : <span th:text="${name}"></span> <br>
    분류 : <select name="category">
                <option value="COMPLAIN">불만 접수</option>
                <option value="SUGGESTION">제안</option>
                <option value="REFUND">환불/교환</option>
                <option value="PRAISE">칭찬해요</option>
                <option value="ETC">기타 문의</option>
            </select> <br><br>
    문의 내용 : <textarea type="text" name="content"></textarea><br />
    첨부 파일 : <input type="file" name="files" id="fileInput" multiple>
    <div id="previewArea">
        <h2>첨부 파일 미리보기:</h2>
        <ul id="fileList">
        </ul>
    </div> <br>
    <button type="submit">문의하기</button>
    <a href="/cs/customer" style="display:inline;">
        <button type="button">취소</button>
    </a>
</form><br>

</body>

<script>
    // 1. 파일 입력 요소와 미리보기 목록 요소를 가져옴
    const fileInput = document.getElementById('fileInput');
    const fileList = document.getElementById('fileList');

    // 2. 파일이 선택되었을 때(change 이벤트) 실행될 이벤트 리스너 설정
    fileInput.addEventListener('change', function(event) {
        // 기존 목록을 비움
        fileList.innerHTML = '';

        // 사용자가 선택한 파일들의 목록(FileList 객체)을 가져옴
        const files = event.target.files;

        // files 목록을 하나씩 순회하며 처리
        for (const file of files) {

            // 3. 리스트 항목(li) 생성
            const listItem = document.createElement('li');
            listItem.textContent = `[파일명: ${file.name}, 크기: ${(file.size / 1024).toFixed(2)} KB]`;

            // 4. FileReader를 사용하여 이미지 미리보기 생성
            if (file.type.startsWith('image/')) {
                const reader = new FileReader();

                // 파일 읽기가 완료되면 실행
                reader.onload = function(e) {
                    const img = document.createElement('img');
                    img.src = e.target.result; // Data URL (미리보기 이미지) 설정
                    img.style.maxWidth = '100px';
                    img.style.maxHeight = '100px';
                    img.style.marginLeft = '10px';

                    listItem.appendChild(img);
                };

                // 파일 데이터를 Data URL 형태로 읽기 시작
                reader.readAsDataURL(file);
            }

            // 5. 목록에 항목 추가
            fileList.appendChild(listItem);
        }
    });
</script>
</html>